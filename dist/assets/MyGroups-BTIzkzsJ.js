import{j as s,r as m,y as N,S as u}from"./index-C1C7CAEQ.js";import{u as S}from"./useQuery-CyVCY3EZ.js";import{j as E}from"./api-CJ7_z0NO.js";const M=({event:e})=>{var t,l;return s.jsxs("div",{className:"mb-6 ",children:[s.jsx("h2",{className:"text-2xl font-bold mb-2",children:(t=e==null?void 0:e.eventDetails)==null?void 0:t.title}),s.jsx("p",{className:"text-gray-400 mb-4",children:(l=e==null?void 0:e.eventDetails)==null?void 0:l.description})]})},y=({title:e,users:t,fallback:l="No members available",loading:i,handleClick:d,setModEmail:c,modEmail:o})=>{const r=n=>{c(n.target.value)};return s.jsxs("div",{className:"bg-zinc-800 rounded-lg text-sm w-full md:text-lg",children:[s.jsxs("div",{className:"border-b border-zinc-700 flex flex-col md:flex-row justify-between items-center p-2",children:[s.jsx("h5",{className:"font-medium p-2 ",children:e}),e==="Moderators"&&s.jsxs("form",{onSubmit:d,className:"flex gap-2 w-5/6 md:w-2/3",children:[s.jsx("input",{type:"email",className:"w-full p-2 rounded-lg text-black placeholder:text-zinc-800",placeholder:"moderator email",onChange:r,value:o}),s.jsx("button",{className:"p-2 bg-green-500 rounded-full w-10 h-10",disabled:i,children:i?"...":"+"})]})]}),s.jsx("div",{className:"px-4",children:s.jsx("ol",{className:"list-decimal p-2",children:(t==null?void 0:t.length)>0?t==null?void 0:t.map((n,f)=>s.jsxs("li",{className:"p-2",children:[n==null?void 0:n.userName," (",n==null?void 0:n.email,")"]},f)):s.jsx("p",{className:"text-gray-500",children:l})})})]})},C=({group:e})=>{const t=e._id,[l,i]=m.useState(!1),[d,c]=m.useState([...e.moderators]),[o,r]=m.useState(e.admin),[n,f]=m.useState([...e.members]),[x,j]=m.useState(""),b=async h=>{if(h.preventDefault(),i(!0),x.trim!=="")try{const a=await fetch("/api/group/addModerator",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({groupId:t,userId:x}),credentials:"include"}),p=await a.json();if(!a.ok)throw new Error(p==null?void 0:p.message)}catch{}finally{j(""),w(),i(!1)}},w=async()=>{i(!0);try{const h=await fetch(`/api/group/${t}`,{credentials:"include"}),a=await h.json();if(c(a==null?void 0:a.moderators),r(a==null?void 0:a.admin),f(a==null?void 0:a.members),!h.ok)throw new Error(a==null?void 0:a.message)}catch{N.error()}finally{i(!1)}};return s.jsxs("div",{className:"mt-4 space-y-4",children:[s.jsx(y,{title:"Admin",users:[e==null?void 0:e.admin],groupId:e==null?void 0:e._id,modEmail:x,setModEmail:j,handleClick:b,loading:l}),s.jsx(y,{title:"Moderators",users:d,groupId:e==null?void 0:e._id,handleClick:b,modEmail:x,setModEmail:j,loading:l,fallback:"No moderators assigned"}),s.jsx(y,{title:"Members",users:n,modEmail:x,setModEmail:j,groupId:e==null?void 0:e._id,handleClick:b,loading:l})]})},G=({group:e,eventId:t})=>{const[l,i]=m.useState(!1),d=()=>i(!l);return s.jsxs("div",{className:" rounded p-2 bg-zinc-600 shadow-md my-4",children:[s.jsxs("div",{className:"flex justify-between items-center cursor-pointer",onClick:d,children:[s.jsx("div",{children:s.jsxs("h4",{className:"text-lg font-medium md:flex gap-1",children:[e==null?void 0:e.name,(e==null?void 0:e.isHead)&&s.jsx("div",{className:" px-1 md:px-2 py-1 bg-yellow-100 flex flex-col md:flex-row text-yellow-800 text-center rounded-full text-sm",children:"Head Group"})]})}),s.jsx("span",{className:"text-blue-600",children:l?"▼":"▶"})]}),l&&s.jsx(C,{group:e})]})},I=({event:e})=>s.jsx("div",{className:"space-y-4",children:e.groups.map(t=>s.jsx(G,{group:t,eventId:e==null?void 0:e._id},t==null?void 0:t._id))}),_=({event:e})=>s.jsxs("div",{className:" rounded-lg p-6 shadow-sm bg-zinc-800",children:[s.jsx(M,{event:e}),s.jsx(I,{event:e})]}),D=()=>{var d,c,o;const{data:e,error:t,isError:l,isPending:i}=S({queryKey:["getgroups"],queryFn:()=>E("admin")});return i?s.jsx("div",{className:"h-screen w-screen flex justify-center items-center",children:s.jsx(u,{})}):l?N.error((c=(d=t==null?void 0:t.response)==null?void 0:d.data)==null?void 0:c.message):e!=null&&e.message?s.jsx("p",{children:(o=N.data)==null?void 0:o.message}):s.jsx("div",{className:"md:p-6 space-y-6",children:(e==null?void 0:e.length)>0?e==null?void 0:e.map(r=>s.jsx(_,{event:r},r==null?void 0:r._id)):s.jsx("p",{children:"No groups available."})})};export{D as default};
