import{u as f,r as d,y as j,j as e,k as b,a as N,S as g}from"./index-C1C7CAEQ.js";import{u as v}from"./useQuery-CyVCY3EZ.js";import{n as w,o as q}from"./api-CJ7_z0NO.js";import{u as S}from"./useMutation-1ScYOpKK.js";import{f as C}from"./time-VhdYBW02.js";import{G as A}from"./iconBase-Bd1mD37r.js";import{T as z}from"./index-0U5k7MBs.js";function B(s){return A({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"},child:[]}]})(s)}const y=({data:s})=>{var p,o,r;const a=s==null?void 0:s._id,x=f(),[i,n]=d.useState(s==null?void 0:s.status),[c,l]=d.useState(null),{mutate:u}=S({mutationFn:({requestId:t,action:h})=>w({requestId:t,action:h}),onMutate:({action:t})=>{l(t)},onSuccess:(t,{action:h})=>{var m;j.success((m=t==null?void 0:t.data)==null?void 0:m.message),n(h==="approve"?"approved":"rejected"),l(null),x.invalidateQueries(["requests"])},onError:()=>{j.error("Try again"),l(null)}});return e.jsxs("tr",{className:"border-b hover:bg-zinc-500 hover:text-black text-white text-center",children:[e.jsx("td",{className:"px-4 py-2",children:(p=s==null?void 0:s.user)==null?void 0:p.userName}),e.jsx("td",{className:"px-4 py-2",children:(o=s==null?void 0:s.user)==null?void 0:o.email}),e.jsx("td",{className:"px-4 py-2",children:(r=s==null?void 0:s.group)==null?void 0:r.name}),e.jsx("td",{className:"px-4 py-2",children:i}),e.jsx("td",{className:"px-4 py-2",children:C(s==null?void 0:s.createdAt)}),e.jsx("td",{className:"text-center px-4 py-2",children:i==="pending"?e.jsxs("div",{className:"flex gap-1 justify-around items-center",children:[e.jsx("button",{className:"w-8 h-8 bg-black rounded-full flex justify-center items-center disabled:opacity-50",onClick:()=>u({requestId:a,action:"approve"}),disabled:c==="approve",children:c==="approve"?e.jsx("span",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"}):e.jsx(z,{color:"green"})}),e.jsx("button",{className:"w-8 h-8 bg-black rounded-full flex justify-center items-center disabled:opacity-50",onClick:()=>u({requestId:a,action:"reject"}),disabled:c==="reject",children:c==="reject"?e.jsx("span",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"}):e.jsx(B,{color:"red"})})]}):e.jsx("p",{children:i})})]})},G=()=>{const{socket:s}=b(),{user:a}=N(),{isPending:x,error:i,data:n,refetch:c}=v({queryKey:["requests"],queryFn:q});d.useEffect(()=>(s==null||s.emit("register_admin",a._id),s==null||s.on("new_request",r=>{c()}),()=>{s==null||s.off("new_request")}),[]);const[l,u]=d.useState((n==null?void 0:n.status)||"all"),p=r=>{u(r.target.value)},o=(n==null?void 0:n.filter(r=>(r==null?void 0:r.status)===l))||[];return i?e.jsx("p",{children:"Error loading requests"}):e.jsxs("div",{className:"overflow-x-auto",children:[x&&e.jsx("div",{className:"flex justify-center items-center h-screen w-screen",children:e.jsx(g,{})}),e.jsxs("div",{className:"flex items-center p-2 gap-2",children:[e.jsx("label",{htmlFor:"sortBy",className:"text-slate-100",children:"Sort By:"}),e.jsxs("select",{id:"sortBy",name:"sortBy",className:"text-slate-100 bg-zinc-600 px-3 py-1 rounded border border-zinc-400 cursor-pointer ",onChange:p,children:[e.jsx("option",{value:"all",children:"All"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"pending",children:"Pending"})]})]}),e.jsxs("table",{className:"min-w-full border border-zinc-800 text-zinc-200",children:[e.jsx("thead",{className:"bg-zinc-900",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"User Name"}),e.jsx("th",{className:"px-4 py-2",children:"Email"}),e.jsx("th",{className:"px-4 py-2",children:"Group"}),e.jsx("th",{className:"px-4 py-2",children:"Status"}),e.jsx("th",{className:"px-4 py-2",children:"Created At"}),e.jsx("th",{className:"px-4 py-2",children:"Action"})]})}),e.jsx("tbody",{children:l==="all"?n==null?void 0:n.map(r=>e.jsx(y,{data:r},r==null?void 0:r._id)):o==null?void 0:o.map(r=>e.jsx(y,{data:r},r==null?void 0:r._id))})]})]})};export{G as default};
